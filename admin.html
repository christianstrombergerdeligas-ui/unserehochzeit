<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin-Panel - Unsere Hochzeit</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ’’</text></svg>">
  <link href="style.css" rel="stylesheet">
  <script src="admin.js"></script>
</head>
<body>
  <header>
    <div class="header-content">
      <h1>Unsere Hochzeit</h1>
      <button id="hamburger" class="hamburger">â˜°</button>
      <button id="adminToggle" class="admin-toggle" title="Admin">ğŸ”’</button>
    </div>
    <nav id="navMenu">
      <a href="index.html">Start</a>
      <a href="geschichte.html" id="historyLink" style="display:none;">Unsere Geschichte</a>
      <a href="termine.html">Termine & Orte</a>
      <a href="anmeldung.html">Anmeldung zur Feier</a>
      <a href="ablaufplan.html" id="ablaufplanLink" style="display:none;">Ablaufplan</a>
      <a href="buffet.html" id="buffetLink" style="display:none;">Buffet</a>
      <a href="fotos.html">Fotos</a>
      <a href="unterhaltung.html">Unterhaltung</a>
      <a href="gaestebuch.html" id="guestbookLink" style="display:none;">GÃ¤stebuch</a>
      <a href="danksagung.html" id="danksagungLink" style="display:none;">Danksagung</a>
      <a href="admin.html" id="adminLink" style="display:none;">âš™ï¸ Admin</a>
    </nav>
  </header>

  <main>
    <section id="adminOnlySection" style="display:none;">
      <div class="admin-hero">
        <div class="admin-hero-content">
          <div class="admin-hero-icon">âš™ï¸</div>
          <h1>Admin-Panel</h1>
          <p class="admin-hero-lead">Verwaltung und Ãœbersicht der Hochzeitswebsite</p>
        </div>
      </div>

      <!-- Countdown zur Hochzeit -->
      <section class="countdown-admin">
        <div class="countdown-content">
          <h2>â° Countdown zur Hochzeit</h2>
          <div class="countdown-display">
            <div class="countdown-item">
              <span id="daysUntil" class="countdown-number">0</span>
              <span class="countdown-label">Tage</span>
            </div>
            <div class="countdown-item">
              <span id="hoursUntil" class="countdown-number">0</span>
              <span class="countdown-label">Stunden</span>
            </div>
          </div>
          <p class="countdown-date">bis zum 15. Mai 2026, 10:30 Uhr</p>
        </div>
      </section>

      <!-- Schnellzugriff Statistiken -->
      <section class="stats-grid">
        <div class="stat-card">
          <div class="stat-icon">ğŸ“‹</div>
          <h3>Anmeldungen</h3>
          <a href="https://docs.google.com/spreadsheets/d/1pHiCuhNfCphu-kKfhQZCjK4CdD8iYDgTXxTt3iL1QH8/edit" target="_blank" class="stat-link">Sheets Ã¶ffnen â†’</a>
        </div>
        <div class="stat-card">
          <div class="stat-icon">ğŸ“”</div>
          <h3>GÃ¤stebuch</h3>
          <a href="https://docs.google.com/spreadsheets/d/1FUX4_U9ZZ9qPX97uGUVOy9RVefLf7loBMCz5I2VySsY/edit" target="_blank" class="stat-link">Sheets Ã¶ffnen â†’</a>
        </div>
        <div class="stat-card">
          <div class="stat-icon">ğŸ“¸</div>
          <h3>Fotos</h3>
          <a href="https://photos.app.goo.gl/TNup4TKHrsxtD7hz8" target="_blank" class="stat-link">Album Ã¶ffnen â†’</a>
        </div>
        <div class="stat-card">
          <div class="stat-icon">ğŸµ</div>
          <h3>Musik-Playlist</h3>
          <a href="https://open.spotify.com/playlist/17b3q1HeMFWk0jFn1SCz0F" target="_blank" class="stat-link">Spotify Ã¶ffnen â†’</a>
        </div>
      </section>

      <!-- Hochzeitsplanung Checkliste -->
      <section class="checklist-container">
        <h2>âœ“ Hochzeitsplanung</h2>
        <div class="checklist">
          <div class="checklist-item">
            <input type="checkbox" id="task1" onchange="saveTasks()">
            <label for="task1">
              <span class="task-title">Location-Details final bestÃ¤tigen</span>
              <span class="due-date">bis 01.03.2026</span>
            </label>
          </div>
          <div class="checklist-item">
            <input type="checkbox" id="task2" onchange="saveTasks()">
            <label for="task2">
              <span class="task-title">MenÃ¼karten drucken lassen</span>
              <span class="due-date">bis 01.04.2026</span>
            </label>
          </div>
          <div class="checklist-item">
            <input type="checkbox" id="task3" onchange="saveTasks()">
            <label for="task3">
              <span class="task-title">Finale GÃ¤steliste prÃ¼fen</span>
              <span class="due-date">bis 01.05.2026</span>
            </label>
          </div>
          <div class="checklist-item">
            <input type="checkbox" id="task4" onchange="saveTasks()">
            <label for="task4">
              <span class="task-title">Dekoration organisieren</span>
              <span class="due-date">bis 01.05.2026</span>
            </label>
          </div>
          <div class="checklist-item">
            <input type="checkbox" id="task5" onchange="saveTasks()">
            <label for="task5">
              <span class="task-title">Musik-Playlist finalisieren</span>
              <span class="due-date">bis 10.05.2026</span>
            </label>
          </div>
          <div class="checklist-item">
            <input type="checkbox" id="task6" onchange="saveTasks()">
            <label for="task6">
              <span class="task-title">Hochzeitsrede vorbereiten</span>
              <span class="due-date">bis 13.05.2026</span>
            </label>
          </div>
        </div>
      </section>

      <section class="admin-status-section">
        <div class="status-container">
          <h2>ğŸ” Feature-Status</h2>
          <p class="section-intro">Ãœbersicht Ã¼ber die Sichtbarkeit der Seiten fÃ¼r GÃ¤ste</p>
          <div class="status-grid">
            <div class="status-card">
              <div class="status-header">
                <span class="status-emoji">ğŸ“…</span>
                <h3>Ablaufplan</h3>
              </div>
              <div class="status-info">
                <span id="ablaufplanStatus" class="status-badge">ğŸ”’ Versteckt bis 01.05.2026</span>
              </div>
            </div>

            <div class="status-card">
              <div class="status-header">
                <span class="status-emoji">ğŸ½ï¸</span>
                <h3>Buffet</h3>
              </div>
              <div class="status-info">
                <span id="buffetStatus" class="status-badge">ğŸ”’ Versteckt bis 01.05.2026</span>
              </div>
            </div>

            <div class="status-card">
              <div class="status-header">
                <span class="status-emoji">ğŸ“–</span>
                <h3>GÃ¤stebuch</h3>
              </div>
              <div class="status-info">
                <span id="guestbookStatus" class="status-badge">ğŸ”’ Versteckt bis 15.05.2026</span>
              </div>
            </div>

            <div class="status-card">
              <div class="status-header">
                <span class="status-emoji">ğŸ’</span>
                <h3>Danksagung</h3>
              </div>
              <div class="status-info">
                <span id="danksagungStatus" class="status-badge">ğŸ”’ Versteckt bis 16.05.2026</span>
              </div>
            </div>

            <div class="status-card">
              <div class="status-header">
                <span class="status-emoji">â¤ï¸</span>
                <h3>Unsere Geschichte</h3>
              </div>
              <div class="status-info">
                <span class="status-badge admin-only">ğŸ”’ Nur Admin</span>
              </div>
            </div>
          </div>
        </div>
      </section>
      <!-- GÃ¤stelisten-Verwaltung -->
      <section class="guest-list-section">
        <div class="guest-list-container">
          <h2>ğŸ‘¥ GÃ¤stelisten-Verwaltung</h2>
          <p class="section-intro">Vergleich zwischen GÃ¤steliste und Anmeldungen</p>
          
          <!-- Gast hinzufÃ¼gen -->
          <div class="add-guest-form">
            <input type="text" id="guestNameInput" placeholder="Name des Gastes eingeben..." class="guest-input">
            <button onclick="addGuest()" class="add-guest-btn">+ Gast hinzufÃ¼gen</button>
            <button onclick="exportGuests()" class="export-btn">ğŸ“¥ Exportieren</button>
            <button onclick="document.getElementById('importFile').click()" class="import-btn">ğŸ“¤ Importieren</button>
            <input type="file" id="importFile" style="display:none;" accept=".json,.csv" onchange="importGuests(event)">
          </div>

          <!-- Statistiken -->
          <div class="guest-stats">
            <div class="stat-box confirmed">
              <div class="stat-number" id="confirmedCount">0</div>
              <div class="stat-label">âœ… Zugesagt</div>
            </div>
            <div class="stat-box declined">
              <div class="stat-number" id="declinedCount">0</div>
              <div class="stat-label">âŒ Abgesagt</div>
            </div>
            <div class="stat-box pending">
              <div class="stat-number" id="pendingCount">0</div>
              <div class="stat-label">â³ Ausstehend</div>
            </div>
            <div class="stat-box total">
              <div class="stat-number" id="totalCount">0</div>
              <div class="stat-label">ğŸ‘¥ Gesamt</div>
            </div>
          </div>

          <!-- GÃ¤stelisten-Tabelle -->
          <div class="guest-list-table-wrapper">
            <table class="guest-table">
              <thead>
                <tr>
                  <th>Name</th>
                  <th>Status</th>
                  <th>Aktion</th>
                </tr>
              </thead>
              <tbody id="guestTableBody">
                <tr class="empty-state">
                  <td colspan="3">ğŸ“‹ Noch keine GÃ¤ste hinzugefÃ¼gt. Starten Sie mit "+ Gast hinzufÃ¼gen"</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </section>
      <section class="admin-links-section">
        <div class="links-container">
          <h2>ğŸ“Š Daten & Verwaltung</h2>
          <p class="section-intro">Direktzugriff auf alle wichtigen Google-Dienste</p>
          <div class="admin-cards-grid">
            <article class="admin-link-card">
              <div class="link-card-icon">ğŸ“‹</div>
              <h3>Anmeldungen</h3>
              <p>Alle RSVP-Anmeldungen zur Feier ansehen und verwalten</p>
              <a href="https://docs.google.com/spreadsheets/d/1SwjMCVS46jWZfRo3TKmKw7Vn-Ctw-ZEu0FNl9DaPRoA/edit" target="_blank" class="external-link-button">
                <span>Sheets Ã¶ffnen</span>
                <span class="button-arrow">â†’</span>
              </a>
            </article>

            <article class="admin-link-card">
              <div class="link-card-icon">ï¿½</div>
              <h3>Anmeldeformular</h3>
              <p>Google Form fÃ¼r GÃ¤ste-Anmeldungen</p>
              <a href="https://docs.google.com/forms/d/e/1FAIpQLSeYBf7pFwShJtmzqDOHgxlK_lLpNWErDJAb5DTMiYKV25i_uA/viewform?usp=sharing" target="_blank" class="external-link-button">
                <span>Form Ã¶ffnen</span>
                <span class="button-arrow">â†’</span>
              </a>
            </article>

            <article class="admin-link-card">
              <div class="link-card-icon">ï¿½ğŸ“”</div>
              <h3>GÃ¤stebuch</h3>
              <p>Alle GÃ¤stebucheintrÃ¤ge und GlÃ¼ckwÃ¼nsche einsehen</p>
              <a href="https://docs.google.com/spreadsheets/d/1FUX4_U9ZZ9qPX97uGUVOy9RVefLf7loBMCz5I2VySsY/edit" target="_blank" class="external-link-button">
                <span>Sheets Ã¶ffnen</span>
                <span class="button-arrow">â†’</span>
              </a>
            </article>

            <article class="admin-link-card">
              <div class="link-card-icon">ğŸ“¸</div>
              <h3>Foto-Album</h3>
              <p>Alle von GÃ¤sten hochgeladenen Fotos verwalten</p>
              <a href="https://photos.app.goo.gl/TNup4TKHrsxtD7hz8" target="_blank" class="external-link-button">
                <span>Album Ã¶ffnen</span>
                <span class="button-arrow">â†’</span>
              </a>
            </article>
          </div>
        </div>
      </section>
    </section>

    <section id="notAdminSection" class="access-denied">
      <div class="denied-content">
        <div class="access-icon">ğŸ”’</div>
        <h2>Zugriff verweigert</h2>
        <p>Diese Seite ist nur im Admin-Modus verfÃ¼gbar.</p>
        <p class="access-hint">Bitte melden Sie sich mit dem Admin-Passwort an.</p>
      </div>
    </section>
  </main>

  <footer>
    Â© 2026 Jenica und Christian
  </footer>

  <script>
  // Stelle sicher, dass Admin-Modus verfÃ¼gbar ist
  window.isAdminMode = () => {
    try {
      return localStorage.getItem('adminLoggedIn') === 'true';
    } catch (e) {
      return false;
    }
  };
  </script>
  <script>
  document.addEventListener('DOMContentLoaded', () => {
    const adminSection = document.getElementById('adminOnlySection');
    const notAdminSection = document.getElementById('notAdminSection');

    function updateAdminView() {
      if (window.isAdminMode && window.isAdminMode()) {
        adminSection.style.display = 'block';
        notAdminSection.style.display = 'none';
        setupExportButtons();
      } else {
        adminSection.style.display = 'none';
        notAdminSection.style.display = 'block';
      }
    }

    function setupExportButtons() {
      // Feature-Status aktualisieren
      updateFeatureStatus();
    }

    function updateFeatureStatus() {
      const today = new Date();
      const ablaufplanDate = new Date(2026, 4, 1);
      const buffetDate = new Date(2026, 4, 1);
      const guestbookDate = new Date(2026, 4, 15);
      const danksagungDate = new Date(2026, 4, 16);

      document.getElementById('ablaufplanStatus').innerHTML = 
        today >= ablaufplanDate ? 'âœ… Sichtbar fÃ¼r alle' : 'ğŸ”’ Versteckt bis 01.05.2026';
      document.getElementById('buffetStatus').innerHTML = 
        today >= buffetDate ? 'âœ… Sichtbar fÃ¼r alle' : 'ğŸ”’ Versteckt bis 01.05.2026';
      document.getElementById('guestbookStatus').innerHTML = 
        today >= guestbookDate ? 'âœ… Sichtbar fÃ¼r alle' : 'ğŸ”’ Versteckt bis 15.05.2026';
      document.getElementById('danksagungStatus').innerHTML = 
        today >= danksagungDate ? 'âœ… Sichtbar fÃ¼r alle' : 'ğŸ”’ Versteckt bis 16.05.2026';
    }

    // GÃ¤stelisten-Funktionen
    function addGuest() {
      const input = document.getElementById('guestNameInput');
      const name = input.value.trim();
      
      if (!name) {
        alert('Bitte einen Namen eingeben!');
        return;
      }
      
      let guests = JSON.parse(localStorage.getItem('weddingGuests')) || [];
      
      if (guests.some(g => g.name.toLowerCase() === name.toLowerCase())) {
        alert('Dieser Gast existiert bereits!');
        return;
      }
      
      guests.push({ name, status: 'pending' });
      localStorage.setItem('weddingGuests', JSON.stringify(guests));
      input.value = '';
      updateGuestList();
    }

    function removeGuest(name) {
      let guests = JSON.parse(localStorage.getItem('weddingGuests')) || [];
      guests = guests.filter(g => g.name !== name);
      localStorage.setItem('weddingGuests', JSON.stringify(guests));
      updateGuestList();
    }

    function setGuestStatus(name, status) {
      let guests = JSON.parse(localStorage.getItem('weddingGuests')) || [];
      const guest = guests.find(g => g.name === name);
      if (guest) {
        guest.status = status;
        localStorage.setItem('weddingGuests', JSON.stringify(guests));
        updateGuestList();
      }
    }

    function exportGuests() {
      let guests = JSON.parse(localStorage.getItem('weddingGuests')) || [];
      
      if (guests.length === 0) {
        alert('Keine GÃ¤ste zum Exportieren vorhanden!');
        return;
      }
      
      // CSV exportieren
      let csv = 'Name,Status\n';
      guests.forEach(guest => {
        csv += `"${guest.name}","${guest.status}"\n`;
      });
      
      // File Download
      const blob = new Blob([csv], { type: 'text/csv' });
      const url = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `gaestenliste_${new Date().toISOString().split('T')[0]}.csv`;
      document.body.appendChild(a);
      a.click();
      window.URL.revokeObjectURL(url);
      document.body.removeChild(a);
    }

    function importGuests(event) {
      const file = event.target.files[0];
      if (!file) return;
      
      const reader = new FileReader();
      reader.onload = function(e) {
        try {
          const content = e.target.result;
          let guests = [];
          
          if (file.name.endsWith('.csv')) {
            // CSV Parse
            const lines = content.split('\n');
            for (let i = 1; i < lines.length; i++) {
              if (lines[i].trim() === '') continue;
              const [name, status] = lines[i].split(',').map(s => s.trim().replace(/^"|"$/g, ''));
              if (name) {
                guests.push({ name, status: status || 'pending' });
              }
            }
          } else if (file.name.endsWith('.json')) {
            // JSON Parse
            guests = JSON.parse(content);
          } else {
            alert('Nur .csv oder .json Dateien werden unterstÃ¼tzt!');
            return;
          }
          
          if (guests.length === 0) {
            alert('Keine gÃ¼ltigen GÃ¤ste in der Datei gefunden!');
            return;
          }
          
          if (confirm(`${guests.length} GÃ¤ste importieren und bestehende Daten ersetzen?`)) {
            localStorage.setItem('weddingGuests', JSON.stringify(guests));
            updateGuestList();
            alert('âœ… GÃ¤ste erfolgreich importiert!');
          }
        } catch (err) {
          alert('âŒ Fehler beim Importieren: ' + err.message);
        }
      };
      reader.readAsText(file);
      
      // Reset file input
      event.target.value = '';
    }

    function updateGuestList() {
      let guests = JSON.parse(localStorage.getItem('weddingGuests')) || [];
      const tbody = document.getElementById('guestTableBody');
      
      if (guests.length === 0) {
        tbody.innerHTML = '<tr class="empty-state"><td colspan="3">ğŸ“‹ Noch keine GÃ¤ste hinzugefÃ¼gt. Starten Sie mit "+ Gast hinzufÃ¼gen"</td></tr>';
      } else {
        tbody.innerHTML = guests.map(guest => `
          <tr class="guest-row status-${guest.status}">
            <td class="guest-name">${guest.name}</td>
            <td class="guest-status">
              <select onchange="setGuestStatus('${guest.name}', this.value)" class="status-select">
                <option value="pending" ${guest.status === 'pending' ? 'selected' : ''}>â³ Ausstehend</option>
                <option value="confirmed" ${guest.status === 'confirmed' ? 'selected' : ''}>âœ… Zugesagt</option>
                <option value="declined" ${guest.status === 'declined' ? 'selected' : ''}>âŒ Abgesagt</option>
              </select>
            </td>
            <td class="guest-action">
              <button onclick="removeGuest('${guest.name}')" class="delete-btn">ğŸ—‘ï¸</button>
            </td>
          </tr>
        `).join('');
      }
      
      // Statistiken aktualisieren
      const confirmed = guests.filter(g => g.status === 'confirmed').length;
      const declined = guests.filter(g => g.status === 'declined').length;
      const pending = guests.filter(g => g.status === 'pending').length;
      
      document.getElementById('confirmedCount').textContent = confirmed;
      document.getElementById('declinedCount').textContent = declined;
      document.getElementById('pendingCount').textContent = pending;
      document.getElementById('totalCount').textContent = guests.length;
    }

    // GÃ¤steliste beim Laden initialisieren
    updateGuestList();

    // Enter-Taste zum HinzufÃ¼gen aktivieren
    if (document.getElementById('guestNameInput')) {
      document.getElementById('guestNameInput').addEventListener('keypress', (e) => {
        if (e.key === 'Enter') addGuest();
      });
    }

    // Countdown Funktion
    function updateCountdown() {
      const weddingDate = new Date(2026, 4, 15, 10, 30);
      const now = new Date();
      const diffTime = weddingDate - now;
      const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
      const diffHours = Math.floor((diffTime % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
      
      document.getElementById('daysUntil').textContent = diffDays;
      document.getElementById('hoursUntil').textContent = diffHours;
    }

    // Checkliste speichern
    function saveTasks() {
      const tasks = {};
      for (let i = 1; i <= 6; i++) {
        tasks[`task${i}`] = document.getElementById(`task${i}`).checked;
      }
      localStorage.setItem('weddingTasks', JSON.stringify(tasks));
    }

    // Checkliste laden
    function loadTasks() {
      const saved = localStorage.getItem('weddingTasks');
      if (saved) {
        const tasks = JSON.parse(saved);
        for (let key in tasks) {
          const checkbox = document.getElementById(key);
          if (checkbox) checkbox.checked = tasks[key];
        }
      }
    }

    // Countdown und Tasks initialisieren
    updateCountdown();
    loadTasks();
    setInterval(updateCountdown, 60000);

    updateAdminView();
    window.addEventListener('adminStateChanged', updateAdminView);
  });
  </script>
</body>
</html>
